package ca.mcgill.ecse211.lab1;

import static ca.mcgill.ecse211.lab1.Resources.*;

public class PController extends UltrasonicController {

  private static final int MOTOR_SPEED = 200;

  public PController() {
    LEFT_MOTOR.setSpeed(MOTOR_SPEED); // Initialize motor rolling forward
    RIGHT_MOTOR.setSpeed(MOTOR_SPEED);
    LEFT_MOTOR.forward();
    RIGHT_MOTOR.forward();
  }

  @Override
  public void processUSData(int distance) {
    filter(distance);

    //if in the middle, go straight
    if(BAND_CENTER-BAND_WIDTH <= distance && distance <= BAND_CENTER+BAND_WIDTH) {
      LEFT_MOTOR.setSpeed(MOTOR_HIGH); // robot moving forward
      RIGHT_MOTOR.setSpeed(MOTOR_HIGH);
      LEFT_MOTOR.forward();
      RIGHT_MOTOR.forward();
    }
    
    //else if too close, go right
    else if (BAND_CENTER-BAND_WIDTH >= distance) {
      LEFT_MOTOR.setSpeed(distance*100); // turn right with speed proportional to distance
      RIGHT_MOTOR.setSpeed(distance*50);
      LEFT_MOTOR.forward();
      RIGHT_MOTOR.forward();
    }
    
    //else go left
    else {
      LEFT_MOTOR.setSpeed(distance*5); // turn left with speed proportional to distance
      RIGHT_MOTOR.setSpeed(distance*10);
      LEFT_MOTOR.forward();
      RIGHT_MOTOR.forward();
    }
  }

  @Override
  public int readUSDistance() {
    return this.distance;
  }

}
